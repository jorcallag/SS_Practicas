#include <stdio.h>
#include <locale.h>
#include <Windows.h>
#include "joaalmcon-LibSS.h"


double MideRetraso(LPCTSTR pMensaje) {
	static LARGE_INTEGER cuenta, c_ini, c_fin, frecuencia;
	static bool primera = true;
	BOOL resFrec, resCont;
	double segs = 0;
	
	if(primera){

		primera = false;
		segs = 0;
		resFrec = QueryPerformanceFrequency(&frecuencia);
		CheckError(resFrec == false, "Error al obtener la frecuencia, intentelo de nuevo.", 1);
		resCont = QueryPerformanceCounter(&c_ini);
		CheckError(resCont == false, "Error al ejecutar el contador", 1);

	}else {

		QueryPerformanceCounter(&c_ini);
		cuenta.QuadPart = c_ini.QuadPart - c_fin.QuadPart;

		segs = (double)cuenta.QuadPart / (double)frecuencia.QuadPart;

		c_ini = c_fin;

		char mensaje[200];
		snprintf(mensaje, 200, "%4.3f", segs);
		OutputDebugString(mensaje);
	}
		
	return segs;

}